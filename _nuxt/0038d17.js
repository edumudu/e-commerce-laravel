(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{486:function(e,r,t){"use strict";t.r(r);t(32),t(18),t(22),t(15),t(308),t(17),t(34),t(35),t(9);var n=t(12),o=(t(31),t(4)),c=t(7),d=t(51);function l(object,e){var r=Object.keys(object);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(object);e&&(t=t.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),r.push.apply(r,t)}return r}function v(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?l(Object(source),!0).forEach((function(r){Object(n.a)(e,r,source[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):l(Object(source)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(source,r))}))}return e}var m={middleware:["auth","haveCart"],transition:"slide-left",components:{ValidationProvider:c.b,ValidationObserver:c.a},fetch:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,e.$axios.$get("/checkout/sessionId");case 2:e.sessionId=r.sent.sessionId;case 3:case"end":return r.stop()}}),r)})))()},data:function(){return{sessionId:"",card:{number:"",name:"",month:"",year:"",cvv:"",address:{cep:"",street:"",district:"",state:"",city:"",addressNumber:"",apto:""},cpf:"",birthdate:"",phone:""},sameAsRegister:!0,cardInfo:{},installments:[],installment:"1|0",sending:!1}},computed:v({installmentsOptions:function(){return this.installments.length?this.installments.map((function(e){return{id:"".concat(e.quantity,"|").concat(e.installmentAmount),name:"".concat(e.quantity,"x of ").concat(e.installmentAmount," - Total ").concat(e.totalAmount)}})):[{id:"1|".concat(this.defaultTotal),name:"1x of ".concat(this.defaultTotal," - Total ").concat(this.defaultTotal)}]},defaultTotal:function(){return this.cartProducts.reduce((function(e,r){return r.price*r.quantity+e}),0).toFixed(2)}},Object(d.c)({cartItems:"cart/cartItems",cartProducts:"cart/cartProducts"})),watch:{sessionId:function(){window.PagSeguroDirectPayment.setSessionId(this.sessionId)}},created:function(){this.installment="1|".concat(this.defaultTotal)},methods:v({getBrand:function(e){var r=this;e.length>=6&&window.PagSeguroDirectPayment.getBrand({cardBin:e.toString().substr(0,6),success:function(e){r.cardInfo=e.brand,r.getInstallments(r.defaultTotal,e.brand.name)},error:function(){r.$toast.error("Card number invalid")}})},getAddress:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function r(){var t,address;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(8===e.card.address.cep.length){r.next=3;break}return e.card.address=v(v({},e.card.address),{},{street:"",district:"",state:"",city:""}),r.abrupt("return");case 3:return e.$nuxt.$loading.start(),r.prev=5,delete(t=e.$axios.create()).defaults.headers.common.Authorization,r.next=10,t.$get("https://viacep.com.br/ws/".concat(e.card.address.cep,"/json/"));case 10:if(!(address=r.sent).erro){r.next=13;break}throw new Error(404);case 13:e.card.address=v(v({},e.card.address),{},{street:address.logradouro,district:address.bairro,state:address.uf,city:address.localidade}),r.next=19;break;case 16:r.prev=16,r.t0=r.catch(5),e.$toast.error(r.t0.message?"Not found this CEP":"Something is wrong, try again latter.");case 19:return r.prev=19,e.$nuxt.$loading.finish(),r.finish(19);case 22:case"end":return r.stop()}}),r,null,[[5,16,19,22]])})))()},sendPayment:function(){var e=this;this.sending=!0,this.$nuxt.$loading.start();var r,t=function(){e.sending=!1,e.$nuxt.$loading.finish()};window.PagSeguroDirectPayment.createCardToken({cardNumber:this.card.number,brand:this.cardInfo.name,cvv:this.card.cvv,expirationMonth:this.card.month,expirationYear:this.card.year,success:(r=Object(o.a)(regeneratorRuntime.mark((function r(n){var o,c,d,l,v,m,f;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return o=n.card,r.prev=1,r.next=4,e.$axios.$post("/checkout/process",{token:o.token,hash:window.PagSeguroDirectPayment.getSenderHash(),installment:e.installment,name:e.card.name,cart:e.cartItems,birthdate:e.card.birthdate,cpf:e.card.cpf,sameAsRegister:e.sameAsRegister,cep:e.card.address.cep,number:e.card.address.addressNumber,apto:e.card.address.apto});case 4:c=r.sent,e.clearCart(),e.$toast.success(c.message),e.$router.push("/checkout/thanks"),r.next=15;break;case 10:r.prev=10,r.t0=r.catch(1),e.$toast.error((null===r.t0||void 0===r.t0||null===(d=r.t0.response)||void 0===d||null===(l=d.data)||void 0===l?void 0:l.message)||(null===r.t0||void 0===r.t0||null===(v=r.t0.response)||void 0===v||null===(m=v.data)||void 0===m||null===(f=m.error)||void 0===f?void 0:f.message)),e.fetchProducts(),e.$router.push("/cart");case 15:return r.prev=15,t(),r.finish(15);case 18:case"end":return r.stop()}}),r,null,[[1,10,15,18]])}))),function(e){return r.apply(this,arguments)}),error:function(r){e.$toast.error(Object.values(r.errors)[0]),t()}})},getInstallments:function(e,r){var t=this;window.PagSeguroDirectPayment.getInstallments({amount:e,brand:r,maxInstallmentNoInterest:0,success:function(e){t.installments=e.installments[r]||[]},error:function(){t.$toast.error("It was not possible to check installments methods, try again later")}})}},Object(d.b)({clearCart:"cart/clearCart",fetchProducts:"cart/fetchProducts"})),head:function(){return{title:"Chekout | ".concat(void 0),script:[{src:"https://stc.sandbox.pagseguro.uol.com.br/pagseguro/api/v2/checkout/pagseguro.directpayment.js"}]}}},f=t(3),component=Object(f.a)(m,(function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("section",{attrs:{id:"page-content"}},[t("div",{staticClass:"container"},[t("h1",{staticClass:"page-title"},[e._v("\n      Checkout\n    ")]),e._v(" "),t("validation-observer",{ref:"form",scopedSlots:e._u([{key:"default",fn:function(r){var n=r.handleSubmit,o=r.invalid;return[t("form",{staticClass:"row align-items-start",on:{submit:function(r){return r.preventDefault(),n(e.sendPayment)}}},[t("div",{staticClass:"row col-12 col-lg-6"},[t("div",{staticClass:"col-12"},[t("h2",{staticClass:"title"},[e._v("\n              Card info\n            ")])]),e._v(" "),t("div",{staticClass:"form-group col-12 col-md-6"},[t("validation-provider",{attrs:{rules:"required|digits:16"},scopedSlots:e._u([{key:"default",fn:function(r){var n=r.errors,o=r.valid;return[t("base-input",{directives:[{name:"mask",rawName:"v-mask",value:"################",expression:"'################'"}],attrs:{name:"card_number",placeholder:"card number","is-valid":o,error:n[0]},on:{keyup:function(r){return e.getBrand(r.target.value)}},model:{value:e.card.number,callback:function(r){e.$set(e.card,"number",r)},expression:"card.number"}})]}}],null,!0)})],1),e._v(" "),t("div",{staticClass:"form-group col-12 col-md-6"},[t("validation-provider",{attrs:{rules:"required|digits:11"},scopedSlots:e._u([{key:"default",fn:function(r){var n=r.errors,o=r.valid;return[t("base-input",{directives:[{name:"mask",rawName:"v-mask",value:"###########",expression:"'###########'"}],attrs:{name:"card_cpf",placeholder:"Holder CPF","is-valid":o,error:n[0]},model:{value:e.card.cpf,callback:function(r){e.$set(e.card,"cpf",r)},expression:"card.cpf"}})]}}],null,!0)})],1),e._v(" "),t("div",{staticClass:"form-group col-12"},[t("validation-provider",{attrs:{rules:"required"},scopedSlots:e._u([{key:"default",fn:function(r){var n=r.errors,o=r.valid;return[t("base-select",{attrs:{name:"installments",placeholder:"Installments",options:e.installmentsOptions,"is-valid":o,error:n[0]},model:{value:e.installment,callback:function(r){e.installment=r},expression:"installment"}})]}}],null,!0)})],1),e._v(" "),t("div",{staticClass:"form-group col-12 col-md-8 col-lg-7"},[t("validation-provider",{attrs:{rules:"required|alpha_spaces"},scopedSlots:e._u([{key:"default",fn:function(r){var n=r.errors,o=r.valid;return[t("base-input",{attrs:{name:"card_name",placeholder:"card name",error:n[0],"is-valid":o},model:{value:e.card.name,callback:function(r){e.$set(e.card,"name",r)},expression:"card.name"}})]}}],null,!0)})],1),e._v(" "),t("div",{staticClass:"form-group col-12 col-md-4 col-lg-5"},[t("validation-provider",{attrs:{rules:"required|max:255"},scopedSlots:e._u([{key:"default",fn:function(r){var n=r.errors,o=r.valid;return[t("base-input",{directives:[{name:"mask",rawName:"v-mask",value:"##/##/####",expression:"'##/##/####'"}],attrs:{name:"card_birthdate",placeholder:"holder birthdate",error:n[0],"is-valid":o},model:{value:e.card.birthdate,callback:function(r){e.$set(e.card,"birthdate",r)},expression:"card.birthdate"}})]}}],null,!0)})],1),e._v(" "),t("div",{staticClass:"form-group col-12 col-sm-4"},[t("validation-provider",{attrs:{rules:"required|digits:2|min_value:1|max_value:12"},scopedSlots:e._u([{key:"default",fn:function(r){var n=r.errors,o=r.valid;return[t("base-input",{directives:[{name:"mask",rawName:"v-mask",value:"##",expression:"'##'"}],attrs:{name:"card_month",placeholder:"month","is-valid":o,error:n[0]},model:{value:e.card.month,callback:function(r){e.$set(e.card,"month",r)},expression:"card.month"}})]}}],null,!0)})],1),e._v(" "),t("div",{staticClass:"form-group col-12 col-sm-4"},[t("validation-provider",{attrs:{rules:"required|digits:4|min_value:"+(new Date).getFullYear()},scopedSlots:e._u([{key:"default",fn:function(r){var n=r.errors,o=r.valid;return[t("base-input",{directives:[{name:"mask",rawName:"v-mask",value:"####",expression:"'####'"}],attrs:{name:"card_year",placeholder:"year","is-valid":o,error:n[0]},model:{value:e.card.year,callback:function(r){e.$set(e.card,"year",r)},expression:"card.year"}})]}}],null,!0)})],1),e._v(" "),t("div",{staticClass:"form-group col-12 col-sm-4"},[t("validation-provider",{attrs:{rules:"required|digits:"+(e.cardInfo.cvvSize||4)},scopedSlots:e._u([{key:"default",fn:function(r){var n=r.errors,o=r.valid;return[t("base-input",{directives:[{name:"mask",rawName:"v-mask",value:"#".repeat(e.cardInfo.cvvSize||4),expression:"'#'.repeat(cardInfo.cvvSize || 4)"}],attrs:{name:"card_cvv",placeholder:"cvv","is-valid":o,error:n[0]},model:{value:e.card.cvv,callback:function(r){e.$set(e.card,"cvv",r)},expression:"card.cvv"}})]}}],null,!0)})],1)]),e._v(" "),t("div",{staticClass:"row col-12 col-lg-6"},[t("div",{staticClass:"col-12"},[t("h2",{staticClass:"title"},[e._v("\n              Address\n            ")])]),e._v(" "),t("div",{staticClass:"form-group col-12"},[t("validation-provider",{attrs:{rules:"required",vid:"sameAsRegister"},scopedSlots:e._u([{key:"default",fn:function(r){var n=r.errors;return[t("base-checkbox",{attrs:{error:n[0]},model:{value:e.sameAsRegister,callback:function(r){e.sameAsRegister=r},expression:"sameAsRegister"}},[e._v("\n                Use same address of my register\n              ")])]}}],null,!0)})],1),e._v(" "),e.sameAsRegister?e._e():[t("div",{staticClass:"form-group col-md-4"},[t("validation-provider",{attrs:{rules:"required_if:sameAsRegister,false|digits:8"},scopedSlots:e._u([{key:"default",fn:function(r){var n=r.errors,o=r.valid;return[t("base-input",{directives:[{name:"mask",rawName:"v-mask",value:"########",expression:"'########'"}],attrs:{name:"CEP",placeholder:"CEP",error:n[0],"is-valid":o},on:{keyup:function(r){return e.getAddress()}},model:{value:e.card.address.cep,callback:function(r){e.$set(e.card.address,"cep",r)},expression:"card.address.cep"}})]}}],null,!0)})],1),e._v(" "),t("div",{staticClass:"form-group col-9 col-md-8 col-lg-8"},[t("validation-provider",{attrs:{rules:"required_if:sameAsRegister,false|max:255"},scopedSlots:e._u([{key:"default",fn:function(r){var n=r.errors,o=r.valid;return[t("base-input",{attrs:{name:"street",placeholder:"Rua",readonly:"",error:n[0],"is-valid":o},model:{value:e.card.address.street,callback:function(r){e.$set(e.card.address,"street",r)},expression:"card.address.street"}})]}}],null,!0)})],1),e._v(" "),t("div",{staticClass:"form-group col-3 col-md-3"},[t("validation-provider",{attrs:{rules:"required_if:sameAsRegister,false|alpha_num|max:10"},scopedSlots:e._u([{key:"default",fn:function(r){var n=r.errors,o=r.valid;return[t("base-input",{attrs:{name:"number",placeholder:"Nº",error:n[0],"is-valid":o},model:{value:e.card.address.addressNumber,callback:function(r){e.$set(e.card.address,"addressNumber",r)},expression:"card.address.addressNumber"}})]}}],null,!0)})],1),e._v(" "),t("div",{staticClass:"form-group col-3 col-md-3"},[t("validation-provider",{attrs:{rules:"alpha_num|max:10"},scopedSlots:e._u([{key:"default",fn:function(r){var n=r.errors,o=r.valid;return[t("base-input",{attrs:{name:"apto",placeholder:"Apto",muted:"Optional",error:n[0],"is-valid":o},model:{value:e.card.address.apto,callback:function(r){e.$set(e.card.address,"apto",r)},expression:"card.address.apto"}})]}}],null,!0)})],1),e._v(" "),t("div",{staticClass:"form-group col-9 col-md-6"},[t("validation-provider",{attrs:{rules:"required_if:sameAsRegister,false|max:255"},scopedSlots:e._u([{key:"default",fn:function(r){var n=r.errors,o=r.valid;return[t("base-input",{attrs:{name:"district",placeholder:"Bairro",readonly:"",error:n[0],"is-valid":o},model:{value:e.card.address.district,callback:function(r){e.$set(e.card.address,"district",r)},expression:"card.address.district"}})]}}],null,!0)})],1),e._v(" "),t("div",{staticClass:"form-group col-md-9"},[t("validation-provider",{attrs:{rules:"required_if:sameAsRegister,false|max:255"},scopedSlots:e._u([{key:"default",fn:function(r){var n=r.errors,o=r.valid;return[t("base-input",{attrs:{name:"city",placeholder:"Cidade",readonly:"",error:n[0],"is-valid":o},model:{value:e.card.address.city,callback:function(r){e.$set(e.card.address,"city",r)},expression:"card.address.city"}})]}}],null,!0)})],1),e._v(" "),t("div",{staticClass:"form-group col-md-3"},[t("validation-provider",{attrs:{rules:"required_if:sameAsRegister,false|length:2"},scopedSlots:e._u([{key:"default",fn:function(r){var n=r.errors,o=r.valid;return[t("base-input",{attrs:{name:"state",placeholder:"Estado",readonly:"",error:n[0],"is-valid":o},model:{value:e.card.address.state,callback:function(r){e.$set(e.card.address,"state",r)},expression:"card.address.state"}})]}}],null,!0)})],1)]],2),e._v(" "),t("div",{staticClass:"form-group mx-auto"},[t("button",{staticClass:"btn-press",attrs:{type:"submit",disabled:e.sending||o}},[e._v("\n            Finalizar compra\n          ")])])])]}}])})],1)])}),[],!1,null,null,null);r.default=component.exports}}]);